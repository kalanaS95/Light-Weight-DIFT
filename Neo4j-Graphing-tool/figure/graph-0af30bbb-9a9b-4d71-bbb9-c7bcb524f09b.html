<!DOCTYPE HTML>
<html>

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-typeahead/2.10.6/jquery.typeahead.min.css"></script>
<!-- <script
  src="https://code.jquery.com/jquery-3.4.0.slim.min.js"
  integrity="sha256-ZaXnYkHGqIhqTbJ6MB4l9Frs/r7U4jlx7ir8PJYBqbI="
  crossorigin="anonymous"></script> -->
  <!-- <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-typeahead/2.10.6/jquery.typeahead.min.js"></script>
  
<style type="text/css">
    html,
    body {
      height: 100%;
      margin: 0px;
    }

    .graph {
      width: 100%;
      height: 100%;
    }

    #main {
      width: 100%;
      height:  85%;
    }

    .interaction {
      width: 100%;
      height:  15%;
      padding-left: 5%;
      padding-right: 5%;
      padding-top: 10px;
      padding-bottom: 10px;

  }   


  </style>
</head>

<body>
  


  





<div id="main">
  <!-- from output.jsbin.com/pejohi -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />

  <div class="graph" id="visualization1"></div>


  <script type="text/javascript">

    var action = function () {
      var container = document.getElementById("visualization");
      container.parentNode.removeChild(container);
    }

    var nodes = new vis.DataSet([{'id': 19, 'group': 'process', 'label': '1834 kalana kalana /bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, sshpass -p', 'title': '_pid:1834<br> Group:kalana<br> User:kalana<br> Executable:/bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, sshpass -p'}, {'id': 18, 'group': 'entry_process', 'label': '1822 kalana kalana /bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, /bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh', 'title': '_pid:1822<br> Group:kalana<br> User:kalana<br> Executable:/bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, /bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh'}, {'id': 21, 'group': 'process', 'label': '1854 kalana kalana scp screengrab.zip', 'title': '_pid:1854<br> Group:kalana<br> User:kalana<br> Executable:scp screengrab.zip'}, {'id': 20, 'group': 'process', 'label': '1841 kalana kalana sshpass -p, scp screengrab.zip', 'title': '_pid:1841<br> Group:kalana<br> User:kalana<br> Executable:sshpass -p, scp screengrab.zip'}, {'id': 23, 'group': 'process', 'label': '1874 kalana kalana sshpass -p', 'title': '_pid:1874<br> Group:kalana<br> User:kalana<br> Executable:sshpass -p'}, {'id': 22, 'group': 'process', 'label': '1867 kalana kalana /bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, sshpass -p', 'title': '_pid:1867<br> Group:kalana<br> User:kalana<br> Executable:/bin/bash /home/kalana/Desktop/Multi-host-screen-grab/attack-script.sh, sshpass -p'}]);
    var edges = new vis.DataSet([{'from': 20, 'to': 21, 'label': 'spawns', 'arrows': 'to', 'title': ''}, {'from': 19, 'to': 20, 'label': 'spawns', 'arrows': 'to', 'title': ''}, {'from': 18, 'to': 22, 'label': 'spawns', 'arrows': 'to', 'title': ''}, {'from': 22, 'to': 23, 'label': 'spawns', 'arrows': 'to', 'title': ''}, {'from': 18, 'to': 19, 'label': 'spawns', 'arrows': 'to', 'title': ''}]);

    var data = {
      nodes: nodes,
      edges: edges
    };

    var options = {
      "manipulation": false,
      "autoResize": true,
      "height": "100%",
      "width": "100%",
      "interaction": {
        "dragNodes": true,
        "dragView": true,
        "hideEdgesOnDrag": false,
        "hideNodesOnDrag": false,
        "hover": true,
        "navigationButtons": true,
        "selectable": true,
        "selectConnectedEdges": true,
        "tooltipDelay": 300,
        "zoomView": true,
        "keyboard": {
          "enabled": false,
          "speed": {
            "x": 10,
            "y": 10,
            "zoom": 0.02
          },
          "bindToWindow": true
        }
      },
      "edges": {
        "font":{
          "size": 14
        },
      },
      "nodes": {
        "font":{
          "size": 14
        },
        "size": 25,
        "shape": "box",
        "color": {
          "border": "#2B7CE9",
          "background": "#97C2FC",
          "highlight": {
            "border": "#2B7CE9",
            "background": "#D2E5FF"
          },
          "hover": {
            "border": "white",
            "background": "white"
          }
        }
      },
      "physics": {
            "barnesHut": {
            "centralGravity": 0,
            "springLength": 240
            }
        },
      "groups": {
        "neighbours": {
          "color": "#E6E6E6"
        },
        "matches": {
          "color": "#97C2FC"
        },
        "acc": {
          "color": "#008C6E"
        },
        "entity": {
          "color": "#497C92" // "#BEAFB4",
        },
        "selected": {
          "color": "#C16060" // "#872D32"
        }
      },

      "locale": "en_EN"
    };

    var container = document.getElementById("visualization1");

    var network = new vis.Network(container, data, options);


    var hasNetworkStabilized = false;
    network.on("stabilized", function (properties) {

      if (!hasNetworkStabilized) {
        hasNetworkStabilized = true;

        network.storePositions();
        setNodesMoveable(data.nodes.get(), false);

        network.fit();
      }
    });

    network.on("dragStart", function (properties) {
      if (properties.nodes.length) {
        var node = data.nodes.get(properties.nodes[0]);
        setNodesMoveable([node], true);
      }
    });

    network.on("dragEnd", function (properties) {
      if (properties.nodes.length) {
        var node = data.nodes.get(properties.nodes[0]);
        setNodesMoveable([node], false);
      }
    });

    setNodesMoveable = function (nodes, isMoveable) {

      // first store positions
      network.storePositions();

      var updates = [];
      var keys = Object.keys(nodes);

      for (var i = 0; i < keys.length; i++) {

        var id = nodes[keys[i]].id;

        var update = {
          id: id,
          fixed: {  // v4: formerly allowToMoveX, allowToMoveY
            x: !isMoveable,
            y: !isMoveable
          }
        };

        updates.push(update);

      }

      data.nodes.update(updates);

      console.log(updates);

    };
  </script>

</div>


</body>

</html>